// @appsignal/plugin-window-events@1.0.24 downloaded from https://ga.jspm.io/npm:@appsignal/plugin-window-events@1.0.24/dist/esm/index.js

import{isError as r}from"@appsignal/core";var n=(void 0,function(){n=Object.assign||function(r){for(var n,e=1,o=arguments.length;e<o;e++){n=arguments[e];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])}return r};return n.apply(this,arguments)});function windowEventsPlugin(e){var o=window;var t=n({onerror:true,onunhandledrejection:true},e);return function(){var n=this;var e={onError:o.onerror,unhandledRejection:o.onunhandledrejection};function _onErrorHandler(r,o,t,a,c){var i=n.createSpan();if(typeof r==="string"&&t===0&&/Script error\.?/.test(r))console.warn("[APPSIGNAL]: Cross-domain or eval script error detected, error ignored");else{c?i.setError(c):i.setError({name:"Error",message:typeof r==="string"?r:'An HTML onerror="" handler failed to execute',stack:"at ".concat(o,":").concat(t).concat(a?":".concat(a):"")});n.send(i)}typeof e.onError==="function"&&e.onError.apply(this,arguments)}function _onUnhandledRejectionHandler(o){var t=n.createSpan();var a;a=o&&o.reason&&r(o.reason)?o.reason:{name:"UnhandledPromiseRejectionError",message:_reasonFromEvent(o)};t.setError(a);n.send(t);typeof e.unhandledRejection==="function"&&e.unhandledRejection.apply(this,arguments)}t.onerror&&(o.onerror=_onErrorHandler);t.onunhandledrejection&&(o.onunhandledrejection=_onUnhandledRejectionHandler)};function _reasonFromEvent(r){return r&&r.reason?typeof r.reason==="string"?r.reason:JSON.stringify(r.reason,circularReplacer()):""}function circularReplacer(){var r=[];var n=[];return function(e,o){if(typeof o==="object"&&o!==null){var t=r.indexOf(o);if(t!==-1)return"[cyclic value: ".concat(n[t]||"root object","]");r.push(o);n.push(e)}return o}}}var e=windowEventsPlugin;export{e as plugin};

